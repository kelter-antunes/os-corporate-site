function RichWidgets_Popup_Editor_init(i,t,e,o,r,n,s,d,a,l){var p=function(i){var t,e=!1;try{if(t=osjs(i).attr("href"),"undefined"==typeof t){var o=i.getAttribute("onclick");if("undefined"!=typeof o&&(e=!0,null!=o)){var r;null!=(r=o.toString().match(/href='([^']*)'/))&&(t=r[1])}}}catch(n){}return[t,e]};osjs().ready(function(u){function c(i,t,e,o,r,n){RichWidgets_Popup_Editor_Close(null);for(var d=u(".ui-dialog-content"),a=0;a<d.length;a++)if(osjs.data(d.get(a),RichWidgets_Popup_Editor_ClosingTag)==RichWidgets_Popup_Editor_ClosingValue)return setTimeout(function(){c(i,t,e,o,r,n)},13),!1;if(u(r).show(),-1==e&&(e=RichWidgets_Popup_Editor_InitialHeight),u(i).show().dialog({dialogClass:"Popup",resizable:!1,autoResize:!1,closeOnEscape:!n,bgiframe:!0,draggable:!1,autoOpen:!0,title:t,modal:!(s===!1),height:e,position:"center",width:-1==o?RichWidgets_Popup_Editor_InitialWidth:o,zIndex:RichWidgets_Popup_Editor_Index,close:function(){u(i).find("iframe").unbind("load"),u(i).find("iframe").attr("src","about:blank"),document.location.href="#_",setTimeout(function(){u(i).find("iframe").empty(),u(i).empty()},13)}}),u(i).find("iframe").height(0),document.location.replace("#"+g)," "==t)u(".ui-dialog-titlebar").height(0),u(".ui-dialog-titlebar-close").attr("class","ui-dialog-titlebar-close-no-title").html("").hide(),u(".ui-dialog").css("overflow","visible");else{var l=u(".ui-dialog-titlebar").height();u(i).parents(".Popup").height(e+l)}n&&u(".ui-dialog-titlebar-close, .ui-dialog-titlebar-close-no-title").remove()}i="#"+i;var h,g=osjs(i).attr("href");try{h=u(i).get(0)}catch(f){}if("undefined"!=typeof h){RichWidgets_Popup_Editor_ParentUrl=n;var _=p(h);linkHref=_[0];var m=_[1];if("undefined"!=typeof linkHref&&""!=linkHref&&"#"!=linkHref&&0!=linkHref.indexOf("javascript:"))m&&h.setAttribute("onclick",h.getAttribute("onclick").toString().replace("window.location.href=","return false;window.location.href=")),null!=h.getAttribute("onclick")&&h.setAttribute("onclick",h.getAttribute("onclick").toString().replace("if( ret != true )","osjs('"+i+"').get(0).setAttribute('confirmed', ret); if( ret != true )")),u(h).click(function(){if(null!=h.getAttribute("disabled")){var i=h.getAttribute("disabled").toString().toLowerCase();if("disabled"==i||-1!=i.indexOf("true"))return!1}if("false"==h.getAttribute("confirmed"))return!1;OsIsIE()&&osFocusBackend.ClearFocusedElement();var n=u("<div style='text-align: center; display: none;'></div>").appendTo("body");n.append('<iframe width="100%" scrolling="auto" height="100%" frameborder="0" src="javascript:void(0);"/>');var s="Loading content...",g=n.prepend("<div id='pleaseWaitDiv' style='text-align: center; color: #FFF; font-size: 18px; padding: 15px 15px 15px 50px; position: absolute; background: #333 url(/CMS_BackOffice/ResourceLink.aspx?ResourceName=ajax-loader) no-repeat 10px 50%; -moz-border-radius: 15px; -webkit-border-radius: 15px; border-radius: 15px; opacity: 0.7; width: 150px; left: 50%; margin-left: -107px;'>"+s+"</div>");c(n,e,o,r,g,l),RichWidgets_Popup_Editor_notifyWidget=t;var f=p(h)[0],_=f.replace(/(\?|&)_=.*?(&|$)/,"$1_="+ +(new Date).now+"$2"),m=_+(_==f?(_.indexOf("?")>=0?"&":"?")+"_="+ +new Date:"");return n.find("iframe").attr("src",m),function(i){i.find("iframe").load(function(){if(RichWidgets_Popup_Editor_resize(i,r,o,!0)&&d){var t=this.contentWindow;t.osAjaxBackend.BindAfterAjaxRequest(function(){t.parent.RichWidgets_Popup_Editor_resize(i,r,o,a)})}})}(n),n=null,g=null,!1});else try{window.OsHandleException(new Error("Popup link id must be the id of a Link or Button Widget with Method Navigate."),u.osErrorCodes.SystemJavascriptError,"Popup_Editor")}catch(f){}}})}function RichWidgets_Popup_Editor_resize(i,t,e,o){if("undefined"==typeof o&&(o=e,e=t,t=i,i=osjs(".ui-dialog-content")),osjs.data(i.get(0),RichWidgets_Popup_Editor_ClosingTag)==RichWidgets_Popup_Editor_ClosingValue)return!1;var r=i.find("iframe")[0],n=document.location.href.replace(/(https?:\/\/[^\/]*).*/,"$1"),s=r.src.replace(/(https?:\/\/[^\/]*).*/,"$1"),d=s.toLowerCase()==n.toLowerCase()||0!=s.indexOf("http");if(!d&&(-1==t||-1==e))throw new Error("A Popup with a screen from a different server (or https) needs explicict width, height set.");if(d){var a=r.contentDocument?r.contentDocument:r.contentWindow.document;if(0==a.documentElement.scrollHeight)return!1}var l=$(i).parents(".Popup").outerHeight(),p=-1==t?osjs(a).width():t,u=-1==e?osjs(a).height():e,c=osjs(".ui-dialog-titlebar").height();-1==e?osjs.browser.msie&&(u+=1):d&&(a.body.style.height="auto"),$(i).height(u),osjs(a).find(".ECT_FeedbackContainer").hide();var h=$(i).parents(".Popup"),g={};if(-1==e){var f=parseInt(h.css("top"));o&&(g.top=Math.max(20,f+(l-(u+c))/2)),g.height=u+c}if(-1==t){var _=parseInt(h.css("left"));o&&(g.left=_+(h.width()-p)/2),g.width=p}if(h.width()==g.width&&h.height()==g.height-(osjs.browser.msie?1:0))return osjs("#pleaseWaitDiv").hide(),$(i).height(u-(osjs.browser.msie?1:0)),!0;h.width()==RichWidgets_Popup_Editor_InitialWidth&&h.height()==RichWidgets_Popup_Editor_InitialHeight&&osjs(r).height(0);var m=function(){setTimeout(function(){$(i).dialog("size"),osjs(".ui-dialog-titlebar-close-no-title").css("display","block"),$(i).find("iframe").height("100%").width(g.width)},13)},b=osjs("#pleaseWaitDiv");return b.hide(),-1==e||-1==t?h.animate(g,{duration:200,complete:m}):m(),a=null,h=null,!0}function RichWidgets_Popup_Editor_Close(){popupToClose=osjs(".ui-dialog-content"),osjs(popupToClose).data(RichWidgets_Popup_Editor_ClosingTag,RichWidgets_Popup_Editor_ClosingValue),setTimeout(function(){$(popupToClose).dialog("close"),$(popupToClose).remove()},0)}var RichWidgets_Popup_Editor_ShowTimeoutMilSecs=200,RichWidgets_Popup_Editor_HideTimeoutMilSecs=800,RichWidgets_Popup_Editor_InitialWidth=210,RichWidgets_Popup_Editor_InitialHeight=100,RichWidgets_Popup_Editor_notifyWidget,RichWidgets_Popup_Editor_Index=4010,RichWidgets_Popup_Editor_ParentUrl,RichWidgets_Popup_Editor_ClosingTag="closing",RichWidgets_Popup_Editor_ClosingValue="true",popupToClose;
function RichWidgets_Popup_Editor_init(a,b,c,d,e,f,g,h,i,j){var k=function(a){var b,c=!1;try{if(b=osjs(a).attr("href"),"undefined"==typeof b){var d=a.getAttribute("onclick");if("undefined"!=typeof d&&(c=!0,null!=d)){var e;null!=(e=d.toString().match(/href='([^']*)'/))&&(b=e[1])}}}catch(f){}return[b,c]};osjs().ready(function(l){function r(a,b,c,d,e,f){RichWidgets_Popup_Editor_Close(null);for(var h=l(".ui-dialog-content"),i=0;i<h.length;i++)if(osjs.data(h.get(i),RichWidgets_Popup_Editor_ClosingTag)==RichWidgets_Popup_Editor_ClosingValue)return setTimeout(function(){r(a,b,c,d,e,f)},13),!1;if(l(e).show(),-1==c&&(c=RichWidgets_Popup_Editor_InitialHeight),l(a).show().dialog({dialogClass:"Popup",resizable:!1,autoResize:!1,closeOnEscape:!f,bgiframe:!0,draggable:!1,autoOpen:!0,title:b,modal:!(g===!1),height:c,position:"center",width:-1==d?RichWidgets_Popup_Editor_InitialWidth:d,zIndex:RichWidgets_Popup_Editor_Index,close:function(){l(a).find("iframe").unbind("load"),l(a).find("iframe").attr("src","about:blank"),document.location.href="#_",setTimeout(function(){l(a).find("iframe").empty(),l(a).empty()},13)}}),l(a).find("iframe").height(0),document.location.replace("#"+m)," "==b)l(".ui-dialog-titlebar").height(0),l(".ui-dialog-titlebar-close").attr("class","ui-dialog-titlebar-close-no-title").html("").hide(),l(".ui-dialog").css("overflow","visible");else{var j=l(".ui-dialog-titlebar").height();l(a).parents(".Popup").height(c+j)}f&&l(".ui-dialog-titlebar-close, .ui-dialog-titlebar-close-no-title").remove()}a="#"+a;var n,m=osjs(a).attr("href");try{n=l(a).get(0)}catch(o){}if("undefined"!=typeof n){RichWidgets_Popup_Editor_ParentUrl=f;var p=k(n);linkHref=p[0];var q=p[1];if("undefined"!=typeof linkHref&&""!=linkHref&&"#"!=linkHref&&0!=linkHref.indexOf("javascript:"))q&&n.setAttribute("onclick",n.getAttribute("onclick").toString().replace("window.location.href=","return false;window.location.href=")),null!=n.getAttribute("onclick")&&n.setAttribute("onclick",n.getAttribute("onclick").toString().replace("if( ret != true )","osjs('"+a+"').get(0).setAttribute('confirmed', ret); if( ret != true )")),l(n).click(function(){if(null!=n.getAttribute("disabled")){var f=n.getAttribute("disabled").toString().toLowerCase();if("disabled"==f||-1!=f.indexOf("true"))return!1}if("false"==n.getAttribute("confirmed"))return!1;OsIsIE()&&osFocusBackend.ClearFocusedElement();var g=l("<div style='text-align: center; display: none;'></div>").appendTo("body");g.append('<iframe width="100%" scrolling="auto" height="100%" frameborder="0" src="javascript:void(0);"/>');var m="Loading content...",o=g.prepend("<div id='pleaseWaitDiv' style='text-align: center; color: #FFF; font-size: 18px; padding: 15px 15px 15px 50px; position: absolute; background: #333 url(/CMS_BackOffice/ResourceLink.aspx?ResourceName=ajax-loader) no-repeat 10px 50%; -moz-border-radius: 15px; -webkit-border-radius: 15px; border-radius: 15px; opacity: 0.7; width: 150px; left: 50%; margin-left: -107px;'>"+m+"</div>");r(g,c,d,e,o,j),RichWidgets_Popup_Editor_notifyWidget=b;var p=k(n)[0],q=p.replace(/(\?|&)_=.*?(&|$)/,"$1_="+ +(new Date).now+"$2"),s=q+(q==p?(q.indexOf("?")>=0?"&":"?")+"_="+ +new Date:"");return g.find("iframe").attr("src",s),function(a){a.find("iframe").load(function(){if(RichWidgets_Popup_Editor_resize(a,e,d,!0)&&h){var b=this.contentWindow;b.osAjaxBackend.BindAfterAjaxRequest(function(){b.parent.RichWidgets_Popup_Editor_resize(a,e,d,i)})}})}(g),g=null,o=null,!1});else try{window.OsHandleException(new Error("Popup link id must be the id of a Link or Button Widget with Method Navigate."),l.osErrorCodes.SystemJavascriptError,"Popup_Editor")}catch(o){}}})}function RichWidgets_Popup_Editor_resize(a,b,c,d){if("undefined"==typeof d&&(d=c,c=b,b=a,a=osjs(".ui-dialog-content")),osjs.data(a.get(0),RichWidgets_Popup_Editor_ClosingTag)==RichWidgets_Popup_Editor_ClosingValue)return!1;var e=a.find("iframe")[0],f=document.location.href.replace(/(https?:\/\/[^\/]*).*/,"$1"),g=e.src.replace(/(https?:\/\/[^\/]*).*/,"$1"),h=g.toLowerCase()==f.toLowerCase()||0!=g.indexOf("http");if(!h&&(-1==b||-1==c))throw new Error("A Popup with a screen from a different server (or https) needs explicict width, height set.");if(h){var i=e.contentDocument?e.contentDocument:e.contentWindow.document;if(0==i.documentElement.scrollHeight)return!1}var j=osjs(a).parents(".Popup").outerHeight(),k=-1==b?osjs(i).width():b,l=-1==c?osjs(i).height():c,m=osjs(".ui-dialog-titlebar").height();-1==c?osjs.browser.msie&&(l+=1):h&&(i.body.style.height="auto"),osjs(a).height(l),osjs(i).find(".ECT_FeedbackContainer").hide();var n=osjs(a).parents(".Popup"),o={};if(-1==c){var p=parseInt(n.css("top"));d&&(o.top=Math.max(20,p+(j-(l+m))/2)),o.height=l+m}if(-1==b){var q=parseInt(n.css("left"));d&&(o.left=q+(n.width()-k)/2),o.width=k}if(n.width()==o.width&&n.height()==o.height-(osjs.browser.msie?1:0))return osjs("#pleaseWaitDiv").hide(),osjs(a).height(l-(osjs.browser.msie?1:0)),!0;n.width()==RichWidgets_Popup_Editor_InitialWidth&&n.height()==RichWidgets_Popup_Editor_InitialHeight&&osjs(e).height(0);var r=function(){setTimeout(function(){osjs(a).dialog("size"),osjs(".ui-dialog-titlebar-close-no-title").css("display","block"),osjs(a).find("iframe").height("100%").width(o.width)},13)},s=osjs("#pleaseWaitDiv");return s.hide(),-1==c||-1==b?n.animate(o,{duration:200,complete:r}):r(),i=null,n=null,!0}function RichWidgets_Popup_Editor_Close(){popupToClose=osjs(".ui-dialog-content"),osjs(popupToClose).data(RichWidgets_Popup_Editor_ClosingTag,RichWidgets_Popup_Editor_ClosingValue),setTimeout(function(){osjs(popupToClose).dialog("close"),osjs(popupToClose).remove()},0)}var RichWidgets_Popup_Editor_ShowTimeoutMilSecs=200,RichWidgets_Popup_Editor_HideTimeoutMilSecs=800,RichWidgets_Popup_Editor_InitialWidth=210,RichWidgets_Popup_Editor_InitialHeight=100,RichWidgets_Popup_Editor_notifyWidget,RichWidgets_Popup_Editor_Index=4010,RichWidgets_Popup_Editor_ParentUrl,RichWidgets_Popup_Editor_ClosingTag="closing",RichWidgets_Popup_Editor_ClosingValue="true",popupToClose;